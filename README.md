# Coding-assignment-for-FEM-course-BUAA_5
BUAA5系《结构分析中的有限元法》编程作业——有限元解算程序

## 程序基本介绍
本平面桁架程序由于涉及到对象的统一定义和处理，故选择简单的面向对象语言Python编写。

程序分为三个部分：引入模块、类的定义、主程序。

### 1. 引入模块

引入**numpy**库用以进行矩阵定义和计算，引入**math**库用以调用基本的数学函数，引入**matplotlib**库用以绘制变形图，引入**openpyxl**库用以读写Excel表格文件，引入**tkinter**库用以用户交互界面设计。

### 2. 类的定义 

定义了五个类和一个外部函数：

四个类分别为**GUI**（用户交互界面类），**Node**（结点类），**Pole**（杆单元类），**Material**（材料类），**Truss**（桁架类），分别用以描述对应的对象。每个类的内部定义有该对象具有的属性和内部方法，例如Node的属性有结点横坐标、纵坐标、结点编号、约束情况、x方向外载荷、y方向外载荷、位移向量序号、x方向结点位移、y方向结点位移，内部方法有`__str__`、`__getitem__`、`__setitem__`等魔法方法，以及`move`函数用以更新发生稳定位移后结点的位置坐标。

外部函数为`data_extract`，它读入**openpyxl**中的**sheet**对象，用于将**sheet**对象转化为可操作的参数列表，即返回存储该**sheet**中每行信息的列表。

### 3. 主程序

程序会自动提取输入文件里的桁架信息并进行计算，输出按文件中结点编号顺序排列的结点位移，以及按文件中杆单元编号顺序排列的杆轴向应力。

最后还会输出一幅位移图，蓝色线段、红色端点代表原桁架位置，绿色线段、黄色端点代表受力稳定后的桁架位置。当然，若位移太小，两位置可能发生重叠而无法分辨位置变化。

利用GUI界面引导用户浏览本地桁架信息文件并传至程序，点击计算即可在原文件目录下找到位移图和计算结果文件。

### 4. 读入Excel文件格式

程序可以识别的Excel文件包含3个sheet，分别为结点信息、单元信息、单元材料信息，三者的命名不可修改且位置不可调换。

结点信息中，从第一列往右分别为：结点编号、结点x坐标（单位: $\text{m}$）、结点y坐标（单位: $\text{m}$）、约束情况、x方向外载荷（单位: $\text{N}$）、y方向外载荷（单位: $\text{N}$）。其中除了约束情况外的所有值均应该为整型或浮点型，而约束情况分为'Null'，'x'，'y'，'x,y'四种可能，无需加引号，逗号使用英文逗号即可。如果输入类型有误，会导致程序运行错误。

单元信息中，从第一列往右分别为：杆单元编号、结点1编号、结点2编号、杆单元材料名、杆单元截面积（单位: $\text{m}^2$）。其中除了杆单元材料名可输入任意字符外，其他值均应该为整型或浮点型。

单元材料信息中，从第一列往右分别为：材料序号、材料名、密度（单位: $\text{kg}/\text{m}^3$）、杨氏模量（单位: $\text{Pa}$）、泊松比。若无密度和泊松比信息可留空，但要程序运行必须输入其他参数，尤其是杨氏模量对求解至关重要。其中除了材料名可输入任意字符外，其他值均应该为整型或浮点型。

会在附件中给出实例Excel文件，即“**桁架x信息.xlsx**”。

### 5. 输出文件格式

输出文件包含一个Excel文件和一个图片文件。

Excel文件名称为原桁架信息文件名后加“计算结果”，该生成的Excel文件包含5个sheet，除原有的桁架信息外，增加了桁架结点位移和杆单元应力这两个sheet。

图片文件即桁架变形图。

## 测试用例

提供了3个可供测试的桁架算例，其输入信息文件为“桁架x信息.xlsx”。

### 1. 桁架1
![桁架1](/images/桁架1.png)

设 $P_1 = 2 \times 10^6 \text{N}$，
$P_2 = 1 \times 10^6 \text{N}$

### 2. 桁架2
![桁架2](/images/桁架2.png)

设结点4上作用 $P = -1 \times 10^5 \text{N}$，各点具体坐标见附件“桁架2信息.xlsx”。

### 3. 桁架3
![桁架3](/images/桁架3.png)
